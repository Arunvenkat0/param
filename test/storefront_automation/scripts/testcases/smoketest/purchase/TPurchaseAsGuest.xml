<?xml version="1.0" encoding="UTF-8" ?>
<testcase version="3" junit-test="true" xmlns="http://xlt.xceptance.com/xlt-script/2">
  <tags>C85047 C84683</tags>
  <description>Test Case ID:(C85047 C84683) (C85047) Smoke Test » Checkout - Retuning Customer » Purchase as Guest   (C84683) Smoke Test » Checkout - Retuning Customer » Starting Checkout » Login Intercept Between Cart and Checkout</description>
  <module name="modules.staticelements.Homepage"/>
  <action name="SearchFirstProductAndCheckResult"/>
  <module name="modules.search.SearchProductByIDOrName">
    <parameter name="SearchText" value="${FirstProductID}"/>
  </module>
  <module name="modules.catalog.ValidateProductDetailsPageStructure"/>
  <action name="StoreProductDataAndAddToCart"/>
  <command name="store" target="${RANDOM.Number(1,10)}" value="FirstProductQuantity">
    <comment>Generate a random quantity and store the value.</comment>
  </command>
  <module name="library.function.FStoreText">
    <parameter name="textElement" value="css=h1.product-name"/>
    <parameter name="textStoreVariableName" value="css=h1.product-name"/>
  </module>
  <command name="storeText" disabled="true" target="css=h1.product-name" value="FirstProductName">
    <comment>Store the product name using the headline on product details page.</comment>
  </command>
  <command name="storeText" target="xpath=id('product-content')/div[@class='product-price']/span" value="FirstProductPrice">
    <comment>Store the product price using the value on product details page.</comment>
  </command>
  <command name="storeEval" target="'$' + (${FirstProductQuantity}*parseFloat('${FirstProductPrice}'.substring(1))).toFixed(2)" value="FirstProductTotalPrice">
    <comment>Calculate the total price and store the result.</comment>
  </command>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="css=.Color .emptyswatch .swatchanchor"/>
  </module>
  <command name="click" disabled="true" target="css=.Color .emptyswatch .swatchanchor">
    <comment>Select size.</comment>
  </command>
  <command name="pause" disabled="true" value="100"/>
  <module name="modules.cart.AddProductToCart">
    <parameter name="Quantity" value="${FirstProductQuantity}"/>
    <parameter name="ProductName" value="${FirstProductName}"/>
    <parameter name="ProductPrice" value="${FirstProductTotalPrice}"/>
    <parameter name="Position" value="1"/>
  </module>
  <module name="modules.cart.GotoCart">
    <comment>Go to Cart View</comment>
  </module>
  <module name="modules.cart.ValidateCartContentForProduct">
    <comment>Validate carted product particulars</comment>
    <parameter name="Name" value="${FirstProductName}"/>
    <parameter name="SinglePrice" value="${FirstProductPrice}"/>
    <parameter name="TotalPriceProduct" value="${FirstProductTotalPrice}"/>
    <parameter name="Quantity" value="${FirstProductQuantity}"/>
    <parameter name="TableRow" value="1"/>
  </module>
  <action name="SearchSecondProductAndCheckResult"/>
  <module name="modules.search.SearchProductByIDOrName">
    <parameter name="SearchText" value="${SecondProductID}"/>
  </module>
  <module name="modules.catalog.ValidateProductDetailsPageStructure"/>
  <action name="SelectColor"/>
  <module name="library.function.FClickAndWaitFor">
    <parameter name="clickElement" value="css=.Color .emptyswatch a"/>
    <parameter name="waitForElement" value="css=.Color .selected"/>
  </module>
  <command name="click" disabled="true" target="css=.Color .emptyswatch a">
    <comment>Select a random color by clicking a color link.</comment>
  </command>
  <command name="waitForElementPresent" disabled="true" target="css=.Color .selected">
    <comment>Wait for the color to be selected.</comment>
  </command>
  <action name="SelectSize"/>
  <module name="library.function.FClickAndWaitFor">
    <parameter name="clickElement" value="css=.size .emptyswatch a[title=S]"/>
    <parameter name="waitForElement" value="css=.size .selected"/>
  </module>
  <command name="click" disabled="true" target="css=.size .emptyswatch a[title=S]"/>
  <command name="click" disabled="true" target="css=.size .emptyswatch a">
    <comment>Select a random size by clicking one of the size options.</comment>
  </command>
  <command name="waitForElementPresent" disabled="true" target="css=.size .selected">
    <comment>Wait for the color to be selected.</comment>
  </command>
  <action name="StoreProductDataAndAddToCart"/>
  <command name="store" target="${RANDOM.Number(1,10)}" value="SecondProductQuantity">
    <comment>Generate a random quantity and store the value.</comment>
  </command>
  <module name="library.function.FStoreText">
    <parameter name="textElement" value="css=h1.product-name"/>
    <parameter name="textStoreVariableName" value="SecondProductName"/>
  </module>
  <command name="storeText" disabled="true" target="css=h1.product-name" value="SecondProductName">
    <comment>Store the product name using the headline on product details page.</comment>
  </command>
  <command name="storeText" target="xpath=id('product-content')/div[@class='product-price']/span" value="SecondProductPrice">
    <comment>Store the product price using the value on product details page.</comment>
  </command>
  <command name="storeEval" target="&quot;$&quot; + (${SecondProductQuantity}*parseFloat('${SecondProductPrice}'.substring(1))).toFixed(2)" value="SecondProductTotalPrice">
    <comment>Calculate the total price and store the result.</comment>
  </command>
  <module name="modules.cart.AddProductToCart">
    <parameter name="Quantity" value="${SecondProductQuantity}"/>
    <parameter name="ProductName" value="${SecondProductName}"/>
    <parameter name="ProductPrice" value="${SecondProductTotalPrice}"/>
    <parameter name="Position" value="1"/>
  </module>
  <module name="modules.cart.GotoCart">
    <comment>Go to Cart View</comment>
  </module>
  <module name="modules.cart.ValidateCartContentForProduct">
    <comment>Validate first carted product particulars</comment>
    <parameter name="Name" value="${SecondProductName}"/>
    <parameter name="SinglePrice" value="${SecondProductPrice}"/>
    <parameter name="TotalPriceProduct" value="${SecondProductTotalPrice}"/>
    <parameter name="Quantity" value="${SecondProductQuantity}"/>
    <parameter name="TableRow" value="2"/>
  </module>
  <module name="modules.cart.ValidateNumberFormatsInCart">
    <comment>Validate Order's total amounts including charges</comment>
  </module>
  <action name="ChooseGuestCheckout"/>
  <command name="clickAndWait" target="css=.cart-actions button[value='Checkout']"/>
  <module name="modules.checkout.ValidateCheckoutLoginPageStructure"/>
  <action name="GuestCheckoutShipping"/>
  <command name="clickAndWait" target="xpath=//*[starts-with(@name, 'dwfrm_login_unregistered')]">
    <comment>Click the guest checkout link.</comment>
  </command>
  <module name="modules.checkout.ValidateCheckoutProgressBar">
    <parameter name="StepNumber" value="1"/>
    <parameter name="StepText" value="Shipping"/>
  </module>
  <module name="modules.checkout.ValidateProductDataInSidebar">
    <comment>checks the first product in the summary</comment>
    <parameter name="Position" value="1"/>
    <parameter name="Name" value="${FirstProductName}"/>
    <parameter name="Quantity" value="${FirstProductQuantity}"/>
    <parameter name="Price" value="${FirstProductTotalPrice}"/>
  </module>
  <module name="modules.checkout.ValidateProductDataInSidebar">
    <comment>checks the second product in the summary</comment>
    <parameter name="Position" value="2"/>
    <parameter name="Name" value="${SecondProductName}"/>
    <parameter name="Quantity" value="${SecondProductQuantity}"/>
    <parameter name="Price" value="${SecondProductTotalPrice}"/>
  </module>
  <module name="modules.adressmanagement.EnterAddressData">
    <parameter name="FirstName" value="${ShippingFirstName}"/>
    <parameter name="LastName" value="${ShippingLastName}"/>
    <parameter name="Address1" value="${ShippingAddress}"/>
    <parameter name="Address2" value=""/>
    <parameter name="Country" value="${ShippingCountry}"/>
    <parameter name="State" value="${ShippingState}"/>
    <parameter name="City" value="${ShippingCity}"/>
    <parameter name="ZipCode" value="${ShippingZipCode}"/>
    <parameter name="Phone" value="${ShippingPhone}"/>
  </module>
  <module name="library.function.FCheck">
    <parameter name="checkElement" value="id=dwfrm_singleshipping_shippingAddress_useAsBillingAddress"/>
  </module>
  <command name="check" disabled="true" target="id=dwfrm_singleshipping_shippingAddress_useAsBillingAddress">
    <comment>Use the same address for billing by ticking the checkbox.</comment>
  </command>
  <module name="modules.checkout.shipping.SelectAndValidateShippingMethods">
    <parameter name="ShippingMethodNumber" value="${ShippingMethodNumber}"/>
    <parameter name="ShippingMethodName" value="${ShippingMethodName}"/>
  </module>
  <module name="modules.checkout.ValidateNumberFormatsCheckoutPage"/>
  <action name="GuestCheckoutBilling">
    <comment>check product information, required fields, enter Shipping details and variate shipping methods</comment>
  </action>
  <command name="clickAndWait" target="name=dwfrm_singleshipping_shippingAddress_save">
    <comment>Proceed to billing.</comment>
  </command>
  <module name="modules.checkout.ValidateCheckoutProgressBar">
    <parameter name="StepNumber" value="2"/>
    <parameter name="StepText" value="Billing"/>
  </module>
  <module name="modules.checkout.billing.ValidateEntryFieldsOnBillingPage">
    <parameter name="FirstName" value="${ShippingFirstName}"/>
    <parameter name="LastName" value="${ShippingLastName}"/>
    <parameter name="Address" value="${ShippingAddress}"/>
    <parameter name="Country" value="${ShippingCountry}"/>
    <parameter name="State" value="${ShippingState}"/>
    <parameter name="City" value="${ShippingCity}"/>
    <parameter name="ZipCode" value="${ShippingZipCode}"/>
  </module>
  <module name="modules.checkout.ValidateProductDataInSidebar">
    <comment>checks the first product in the summary</comment>
    <parameter name="Position" value="1"/>
    <parameter name="Name" value="${FirstProductName}"/>
    <parameter name="Quantity" value="${FirstProductQuantity}"/>
    <parameter name="Price" value="${FirstProductTotalPrice}"/>
  </module>
  <module name="modules.checkout.ValidateProductDataInSidebar">
    <comment>checks the second product in the summary</comment>
    <parameter name="Position" value="2"/>
    <parameter name="Name" value="${SecondProductName}"/>
    <parameter name="Quantity" value="${SecondProductQuantity}"/>
    <parameter name="Price" value="${SecondProductTotalPrice}"/>
  </module>
  <module name="modules.checkout.shipping.ValidateShippingAddressInSidebar">
    <comment>Shipping Address Validation</comment>
    <parameter name="Name" value="${ShippingFirstName} ${ShippingLastName}"/>
    <parameter name="Address" value="${ShippingAddress}"/>
    <parameter name="City" value="${ShippingCity}"/>
    <parameter name="StateShort" value="${ShippingStateShortName}"/>
    <parameter name="ZipCode" value="${ShippingZipCode}"/>
    <parameter name="Country" value="${ShippingCountry}"/>
  </module>
  <module name="modules.checkout.ValidateNumberFormatsCheckoutPage"/>
  <module name="library.function.FType">
    <parameter name="typeElement" value="id=dwfrm_billing_billingAddress_email_emailAddress"/>
    <parameter name="inputString" value="${RandomEmailAddress}"/>
  </module>
  <command name="type" disabled="true" target="id=dwfrm_billing_billingAddress_email_emailAddress" value="${RandomEmailAddress}"/>
  <module name="modules.checkout.billing.SelectAndValidatePaymentMethods">
    <comment>Validate All Payment Methods available on page</comment>
  </module>
  <module name="modules.checkout.billing.SelectCreditCardAndEnterData">
    <parameter name="CardName" value="${CreditCardFirstName} ${CreditCardLastName}"/>
    <parameter name="Type" value="${CreditCardType}"/>
    <parameter name="Number" value="${CreditCardNumber}"/>
    <parameter name="ExpireMonth" value="${CreditCardExpiryMonthName}"/>
    <parameter name="ExpireYear" value="${CreditCardExpiryYear}"/>
    <parameter name="SecurityCode" value="${CreditCardSecurityCode}"/>
  </module>
  <action name="GuestCheckoutPlaceOrder">
    <comment>check product information, required fields, enter Shipping details and variate shipping methods</comment>
  </action>
  <command name="clickAndWait" target="css=.button-fancy-large">
    <comment>Click button to place order.</comment>
  </command>
  <module name="modules.checkout.ValidateCheckoutProgressBar">
    <parameter name="StepNumber" value="3"/>
    <parameter name="StepText" value="Place Order"/>
  </module>
  <module name="modules.checkout.ValidateProductDataOnPlaceOrderPage">
    <parameter name="Position" value="1"/>
    <parameter name="Name" value="${FirstProductName}"/>
    <parameter name="Quantity" value="${FirstProductQuantity}"/>
    <parameter name="PriceTotal" value="${FirstProductTotalPrice}"/>
  </module>
  <module name="modules.checkout.ValidateProductDataOnPlaceOrderPage">
    <parameter name="Position" value="2"/>
    <parameter name="Name" value="${SecondProductName}"/>
    <parameter name="Quantity" value="${SecondProductQuantity}"/>
    <parameter name="PriceTotal" value="${SecondProductTotalPrice}"/>
  </module>
  <module name="modules.checkout.shipping.ValidateShippingAddressInSidebar">
    <parameter name="Name" value="${ShippingFirstName} ${ShippingLastName}"/>
    <parameter name="Address" value="${ShippingAddress}"/>
    <parameter name="City" value="${ShippingCity}"/>
    <parameter name="StateShort" value="${ShippingStateShortName}"/>
    <parameter name="ZipCode" value="${ShippingZipCode}"/>
    <parameter name="Country" value="${ShippingCountry}"/>
  </module>
  <module name="modules.checkout.billing.ValidateBillingAddressInSidebar">
    <parameter name="Name" value="${ShippingFirstName} ${ShippingLastName}"/>
    <parameter name="Address" value="${ShippingAddress}"/>
    <parameter name="City" value="${ShippingCity}"/>
    <parameter name="State_Short" value="${ShippingStateShortName}"/>
    <parameter name="ZipCode" value="${ShippingZipCode}"/>
    <parameter name="Country" value="${ShippingCountry}"/>
  </module>
  <module name="modules.checkout.billing.ValidatePaymentCreditCardInSidebar">
    <parameter name="Name" value="${CreditCardFirstName} ${CreditCardLastName}"/>
    <parameter name="Type" value="${CreditCardTypeShort}"/>
    <parameter name="NumberLast4" value="${CreditCardNumberLast4Digits}"/>
    <parameter name="ExpireMonthShort" value="${CreditCardExpiryMonthNumber}"/>
    <parameter name="ExpireYear" value="${CreditCardExpiryYear}"/>
  </module>
  <module name="modules.checkout.ValidateNumberFormatsCheckoutPage"/>
  <action name="GuestSubmitOrder"/>
  <command name="clickAndWait" target="name=submit">
    <comment>Place the order by clicking the button.</comment>
  </command>
  <module name="library.function.FAssertText">
    <parameter name="textElement" value="css=#primary h1"/>
    <parameter name="textPattern" value="Thank you for your order."/>
  </module>
  <command name="assertText" target="css=#primary h1" value="Thank you for your order."/>
  <command name="assertText" target="css=.order-date span:first-child" value="Order Placed"/>
  <command name="assertText" target="css=#main .order-total td:first-child" value="glob:Order Total:"/>
  <module name="modules.checkout.summary.ValidateProductDataOnSummaryPage">
    <parameter name="Position" value="1"/>
    <parameter name="Name" value="${FirstProductName}"/>
    <parameter name="Quantity" value="${FirstProductQuantity}"/>
    <parameter name="Price" value="${FirstProductTotalPrice}"/>
  </module>
  <module name="modules.checkout.summary.ValidateProductDataOnSummaryPage">
    <parameter name="Position" value="2"/>
    <parameter name="Name" value="${SecondProductName}"/>
    <parameter name="Quantity" value="${SecondProductQuantity}"/>
    <parameter name="Price" value="${SecondProductTotalPrice}"/>
  </module>
  <module name="modules.checkout.summary.ValidateShippingDataSummaryPage">
    <parameter name="FirstName" value="${ShippingFirstName}"/>
    <parameter name="LastName" value="${ShippingLastName}"/>
    <parameter name="Address" value="${ShippingAddress}"/>
    <parameter name="City" value="${ShippingCity}"/>
    <parameter name="StateShort" value="${ShippingStateShortName}"/>
    <parameter name="ZipCode" value="${ShippingZipCode}"/>
    <parameter name="Country" value="${ShippingCountry}"/>
    <parameter name="ShippingMethod" value="${ShippingMethodName}"/>
    <parameter name="ShippingStatus" value="Not Shipped"/>
  </module>
  <module name="modules.checkout.summary.ValidateBillingAddressSummaryPage">
    <parameter name="Name" value="${ShippingFirstName} ${ShippingLastName}"/>
    <parameter name="Address" value="${ShippingAddress}"/>
    <parameter name="City" value="${ShippingCity}"/>
    <parameter name="StateShort" value="${ShippingStateShortName}"/>
    <parameter name="ZipCode" value="${ShippingZipCode}"/>
    <parameter name="Country" value="${ShippingCountry}"/>
  </module>
  <module name="modules.checkout.ValidateNumberFormatsCheckoutPage"/>
  <module name="modules.checkout.summary.ValidatePaymentCreditCardSummaryPage">
    <parameter name="Type" value="${CreditCardTypeShort}"/>
    <parameter name="Last4" value="${CreditCardNumberLast4Digits}"/>
    <parameter name="ExpireMonthNumber" value="${CreditCardExpiryMonthNumber}"/>
    <parameter name="Expire_Year" value="${CreditCardExpiryYear}"/>
  </module>
  <action name="GuestReturn2Home"/>
  <module name="modules.staticelements.Return2Home"/>
</testcase>
