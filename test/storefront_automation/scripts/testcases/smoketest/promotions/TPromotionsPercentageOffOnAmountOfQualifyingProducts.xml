<?xml version="1.0" encoding="UTF-8"?>
<testcase xmlns="http://xlt.xceptance.com/xlt-script/2" version="4" junit-test="true">
  <tags>C130245</tags>
  <description>Test Case ID:(C130245)</description>
  <module name="library.module.app.busmgr.EnablePromotion">
    <parameter name="SiteName" value="${SiteName}"/>
    <parameter name="PromotionName" value="${PromotionName}"/>
  </module>
  <module name="library.module.app.sitegenesis.OpenShoppingSite"/>
  <module name="library.module.app.sitegenesis.OpenCatalogDisplayCategoryLevel3">
    <parameter name="Level1CategoryName" value="${CatalogLevel1}"/>
    <parameter name="Level2CategoryName" value="${CatalogLevel2}"/>
    <parameter name="Level3CategoryName" value="${CatalogLevel3NegativeTest}"/>
  </module>
  <action name="VERIFY-NoPromoCallouts"/>
  <module name="library.function.FAssertCountOnPage">
    <parameter name="string" value="${PromotionName}"/>
    <parameter name="numberExpected" value="0"/>
  </module>
  <action name="OpenCatalogSection"/>
  <module name="library.module.app.sitegenesis.OpenCatalogDisplayCategoryLevel3">
    <parameter name="Level1CategoryName" value="${CatalogLevel1}"/>
    <parameter name="Level2CategoryName" value="${CatalogLevel2}"/>
    <parameter name="Level3CategoryName" value="${CatalogLevel3}"/>
  </module>
  <action name="VERIFY-PromotionCallouts"/>
  <module name="library.function.FAssertText">
    <parameter name="textElement" value="css=div.promotional-message.first "/>
    <parameter name="textPattern" value="regexpi:${PromotionName}"/>
  </module>
  <module name="library.function.FAssertCountOnPage">
    <parameter name="string" value="${PromotionName}"/>
    <parameter name="numberExpected" value="5"/>
  </module>
  <action name="SelectProduct"/>
  <module name="library.module.app.sitegenesis.productgriddisplay.ClickProductQuickViewLink">
    <parameter name="ProductName" value="${ProductName}"/>
  </module>
  <action name="VERIFY-PromotionCallout"/>
  <module name="library.function.FAssertText">
    <parameter name="textElement" value="css=div.promotion-callout"/>
    <parameter name="textPattern" value="regexpi:${PromotionName} Details.*"/>
  </module>
  <module name="library.function.FClickAndWait">
    <parameter name="clickElement" value="//a[contains(text(),'View Full Details')]"/>
  </module>
  <action name="VERIFY-FullDeatailsCallout"/>
  <module name="library.function.FAssertText">
    <parameter name="textElement" value="css=div.promotion-callout"/>
    <parameter name="textPattern" value="regexpi:${PromotionName} Details.*"/>
  </module>
  <action name="SelectSize"/>
  <module name="library.module.app.sitegenesis.quickview.SelectSize">
    <parameter name="Size" value="${Size}"/>
  </module>
  <command name="pause" value="2000"/>
  <action name="SelectColor"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="css=a.swatchanchor[title='${Color}']"/>
  </module>
  <command name="pause" value="2000"/>
  <action name="UseQuickViewToAddProductToCart"/>
  <module name="library.module.app.sitegenesis.quickview.AddToCart"/>
  <action name="VERIFY-NoCalloutInShoppingCart"/>
  <module name="library.module.app.sitegenesis.header.OpenShoppingCart"/>
  <module name="library.function.FAssertCountOnPage">
    <parameter name="string" value="${PromotionName}"/>
    <parameter name="numberExpected" value="0"/>
  </module>
  <action name="CheckoutAsGuest"/>
  <module name="library.module.app.sitegenesis.header.GoToCheckout"/>
  <module name="library.module.app.sitegenesis.checkout.login.ClickCheckoutAsGuest"/>
  <module name="library.module.app.sitegenesis.checkout.shipping.EnterAddressData">
    <parameter name="FirstName" value="${ShippingFirstName}"/>
    <parameter name="LastName" value="${ShippingLastName}"/>
    <parameter name="Address1" value="${ShippingAddress}"/>
    <parameter name="Address2" value=""/>
    <parameter name="Country" value="${ShippingCountry}"/>
    <parameter name="State" value="${ShippingState}"/>
    <parameter name="City" value="${ShippingCity}"/>
    <parameter name="ZipCode" value="${ShippingZipCode}"/>
    <parameter name="Phone" value="${ShippingPhone}"/>
  </module>
  <action name="SelectShipping"/>
  <module name="library.module.app.sitegenesis.checkout.shipping.SelectShippingMethod">
    <parameter name="ShippingMethodName" value="${ShippingMethod}"/>
  </module>
  <module name="library.module.app.sitegenesis.util.FSelectUseThisAddressForBilling"/>
  <action name="Continue"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="css=button[value='Continue &gt;']"/>
  </module>
  <action name="CompleteOrder"/>
  <module name="library.module.app.sitegenesis.checkout.billing.EnterBillingEmail">
    <parameter name="EmailAddress" value="${EmailAddress}"/>
  </module>
  <module name="library.module.app.sitegenesis.checkout.billing.EnterCreditCardInfo">
    <parameter name="NameOnCard" value="${NameOnCard}"/>
    <parameter name="CardType" value="${CardType}"/>
    <parameter name="CardNumber" value="${CardNumber}"/>
    <parameter name="ExpirationMonth" value="${ExpirationMonth}"/>
    <parameter name="ExpirationYear" value="${ExpirationYear}"/>
    <parameter name="SecurityCode" value="${SecurityCode}"/>
  </module>
  <module name="library.function.FClickAndWait">
    <parameter name="clickElement" value="css=button[value='Continue &gt;']"/>
  </module>
  <action name="VERIFY-PromotionBeforeSubmit"/>
  <module name="library.function.FAssertText">
    <parameter name="textElement" value="//td[@class='cart-promo']/div/span[@class='value']"/>
    <parameter name="textPattern" value="${PromotionName}"/>
  </module>
  <module name="library.function.FAssertText">
    <parameter name="textElement" value="//div[@class='order-summary-footer']//tr[@class='order-discount discount']/td[2]"/>
    <parameter name="textPattern" value="${ExpectedDiscount}"/>
  </module>
  <action name="SubmitOrder"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="css=button[value=&quot;Submit Order&quot;]"/>
  </module>
  <action name="VERIFY-PromoDiscountOnOrderConfirmation"/>
  <module name="library.function.FAssertText">
    <parameter name="textElement" value="//div[@class='order-confirmation-details']//tr[@class='order-discount discount']/td[2]"/>
    <parameter name="textPattern" value="${ExpectedDiscount}"/>
  </module>
  <action name="CleanUp"/>
  <module name="library.module.app.busmgr.DisablePromotion">
    <parameter name="SiteName" value="${SiteName}"/>
    <parameter name="PromotionName" value="${PromotionName}"/>
  </module>
</testcase>