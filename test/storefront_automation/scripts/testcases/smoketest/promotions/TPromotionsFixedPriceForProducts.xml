<?xml version="1.0" encoding="UTF-8"?>
<testcase xmlns="http://xlt.xceptance.com/xlt-script/2" version="4" junit-test="true">
  <tags>C130270</tags>
  <description>Test Case ID:(C130270)</description>
  <module name="library.module.app.busmgr.EnableExclusivePromotion">
    <parameter name="SiteName" value="${SiteName}"/>
    <parameter name="PromotionName" value="${PromotionName}"/>
  </module>
  <module name="library.module.app.sitegenesis.OpenShoppingSite"/>
  <module name="library.module.app.sitegenesis.OpenCatalogDisplayCategoryLevel3">
    <parameter name="Level1CategoryName" value="${CatalogLevel1}"/>
    <parameter name="Level2CategoryName" value="${CatalogLevel2}"/>
    <parameter name="Level3CategoryName" value="${CatalogLevel3}"/>
  </module>
  <action name="VERIFY-PromoMessage"/>
  <module name="library.function.FAssertCountOnPage">
    <parameter name="string" value="${PromotionName}"/>
    <parameter name="numberExpected" value="12"/>
  </module>
  <action name="Refine"/>
  <module name="library.module.app.sitegenesis.productgriddisplay.SelectPriceRefinement">
    <parameter name="PriceLabelText" value="$100 - $499.99"/>
  </module>
  <action name="DisplayAll"/>
  <module name="library.function.FSelect">
    <parameter name="element" value="css=#grid-paging-header"/>
    <parameter name="selection" value="regexp:View All.*"/>
  </module>
  <action name="SelectFirstProduct"/>
  <module name="library.module.app.sitegenesis.productgriddisplay.ClickProductQuickViewLink">
    <parameter name="ProductName" value="${ProductName1}"/>
  </module>
  <module name="library.module.app.sitegenesis.quickview.SelectSize">
    <parameter name="Size" value="M"/>
  </module>
  <module name="library.module.app.sitegenesis.quickview.AddToCart"/>
  <action name="VERIFY-PromoMessage"/>
  <module name="library.module.app.sitegenesis.header.OpenShoppingCart"/>
  <module name="library.function.FAssertText">
    <parameter name="textElement" value="css=div.promo.first"/>
    <parameter name="textPattern" value="- ${PromotionName}"/>
  </module>
  <action name="AddSecondProduct"/>
  <module name="library.module.app.sitegenesis.OpenCatalogDisplayCategoryLevel3">
    <parameter name="Level1CategoryName" value="${CatalogLevel1}"/>
    <parameter name="Level2CategoryName" value="${CatalogLevel2}"/>
    <parameter name="Level3CategoryName" value="${CatalogLevel3}"/>
  </module>
  <module name="library.module.app.sitegenesis.productgriddisplay.SelectRefinementColor">
    <parameter name="Color" value="White"/>
  </module>
  <module name="library.module.app.sitegenesis.productgriddisplay.SelectNumberOfProductsToDisplay">
    <parameter name="numberOfProductsToDisplay" value="60"/>
  </module>
  <module name="library.module.app.sitegenesis.productgriddisplay.SelectSorting">
    <parameter name="SortSelectionName" value="Price High To Low"/>
  </module>
  <module name="library.module.app.sitegenesis.productgriddisplay.ClickProductQuickViewLink">
    <parameter name="ProductName" value="${ProductName2}"/>
  </module>
  <module name="library.module.app.sitegenesis.productgriddisplay.SelectPriceRefinement">
    <parameter name="PriceLabelText" value="$50 - $99.99"/>
  </module>
  <module name="library.module.app.sitegenesis.quickview.SelectSize">
    <parameter name="Size" value="M"/>
  </module>
  <module name="library.module.app.sitegenesis.quickview.AddToCart"/>
  <command name="pause" value="1000"/>
  <action name="VERIFY-PromoMessage"/>
  <module name="library.module.app.sitegenesis.header.OpenShoppingCart"/>
  <module name="library.function.FAssertText">
    <parameter name="textElement" value="css=.promo-adjustment"/>
    <parameter name="textPattern" value="${PromotionName}"/>
  </module>
  <module name="library.function.FAssertCountOnPage">
    <parameter name="string" value="${PromotionName}"/>
    <parameter name="numberExpected" value="2"/>
  </module>
  <action name="ChangeQuantities"/>
  <module name="library.function.FType">
    <parameter name="typeElement" value="css=input[name='dwfrm_cart_shipments_i0_items_i1_quantity']"/>
    <parameter name="inputString" value="2"/>
  </module>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="css=#update-cart"/>
  </module>
  <action name="VERIFY-PromoMessage"/>
  <module name="library.module.app.sitegenesis.cart.VerifyPromoNameForCartItem">
    <parameter name="rowNumber" value="1"/>
    <parameter name="promoName" value="${PromotionName}"/>
  </module>
  <module name="library.module.app.sitegenesis.cart.VerifyPromoNameForCartItem">
    <parameter name="rowNumber" value="2"/>
    <parameter name="promoName" value="${PromotionName}"/>
  </module>
  <module name="library.function.FAssertText" disabled="true">
    <parameter name="textElement" value="css=tr.cart-row:nth-child(1) &gt; td:nth-child(6) &gt; div:nth-child(2)"/>
    <parameter name="textPattern" value="${PromotionName}"/>
  </module>
  <module name="library.function.FAssertText" disabled="true">
    <parameter name="textElement" value="css=tr.cart-row:nth-child(2) &gt; td:nth-child(6) &gt; div:nth-child(2)"/>
    <parameter name="textPattern" value="${PromotionName}"/>
  </module>
  <action name="ChangeAgain"/>
  <module name="library.function.FType">
    <parameter name="typeElement" value="css=input[name='dwfrm_cart_shipments_i0_items_i1_quantity']"/>
    <parameter name="inputString" value="3"/>
  </module>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="css=#update-cart"/>
  </module>
  <action name="VERIFY-PromoMessages"/>
  <command name="pause" value="1500"/>
  <module name="library.module.app.sitegenesis.cart.VerifyPromoNameForCartItem">
    <parameter name="rowNumber" value="1"/>
    <parameter name="promoName" value="${PromotionName}"/>
  </module>
  <module name="library.module.app.sitegenesis.cart.VerifyPromoNameForCartItem">
    <parameter name="rowNumber" value="2"/>
    <parameter name="promoName" value="2 x ${PromotionName}"/>
  </module>
  <action name="ChangeFirstItemQty"/>
  <command name="pause" value="1500"/>
  <module name="library.function.FType">
    <parameter name="typeElement" value="css=input[name='dwfrm_cart_shipments_i0_items_i0_quantity']"/>
    <parameter name="inputString" value="3"/>
  </module>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="css=#update-cart"/>
  </module>
  <action name="VERIFY-PromoApplication"/>
  <command name="pause" value="1500"/>
  <module name="library.module.app.sitegenesis.cart.VerifyPromoNameForCartItem">
    <parameter name="rowNumber" value="1"/>
    <parameter name="promoName" value="2 x ${PromotionName}"/>
  </module>
  <module name="library.module.app.sitegenesis.cart.VerifyPromoNameForCartItem">
    <parameter name="rowNumber" value="2"/>
    <parameter name="promoName" value="2 x ${PromotionName}"/>
  </module>
  <action name="VERIFY-FinalCart"/>
  <action name="FirstProduct"/>
  <command name="pause" value="1500"/>
  <module name="library.module.app.sitegenesis.cart.VerifyPromoNameForCartItem">
    <parameter name="rowNumber" value="1"/>
    <parameter name="promoName" value="2 x ${PromotionName}"/>
  </module>
  <module name="library.function.FAssertText">
    <parameter name="textElement" value="css=tr.cart-row:nth-child(1) &gt; td:nth-child(6) &gt; span:nth-child(3) &gt; span:nth-child(1)"/>
    <parameter name="textPattern" value="${ItemTotal1}"/>
  </module>
  <action name="SecondProduct"/>
  <command name="pause" value="1500"/>
  <module name="library.module.app.sitegenesis.cart.VerifyPromoNameForCartItem">
    <parameter name="rowNumber" value="2"/>
    <parameter name="promoName" value="2 x ${PromotionName}"/>
  </module>
  <module name="library.function.FAssertText">
    <parameter name="textElement" value="css=tr.cart-row:nth-child(2) &gt; td.item-total &gt; span.price-adjusted-total &gt; span"/>
    <parameter name="textPattern" value="${ItemTotal2}"/>
  </module>
  <action name="CleanUp"/>
  <module name="library.module.app.busmgr.DisablePromotion">
    <parameter name="SiteName" value="${SiteName}"/>
    <parameter name="PromotionName" value="${PromotionName}"/>
  </module>
</testcase>