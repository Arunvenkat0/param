<?xml version="1.0" encoding="UTF-8"?>
<testcase xmlns="http://xlt.xceptance.com/xlt-script/2" version="4" junit-test="true">
  <tags>C130246</tags>
  <description>Test Case ID:(C130246)</description>
  <module name="library.module.app.busmgr.EnableExclusivePromotion">
    <parameter name="SiteName" value="${SiteName}"/>
    <parameter name="PromotionName" value="${PromotionName}"/>
  </module>
  <module name="library.module.app.sitegenesis.OpenShoppingSite"/>
  <module name="library.module.app.sitegenesis.OpenCatalogDisplayCategoryLevel2">
    <parameter name="Level1CategoryName" value="${CatalogLevel1}"/>
    <parameter name="Level2CategoryName" value="${CatalogLevel2}"/>
  </module>
  <action name="CheckNoPromotion"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="//a[text()=&quot;${NonPromoRefinement}&quot;]"/>
  </module>
  <module name="library.function.FWaitForText">
    <parameter name="textElement" value="css=a.name-link[title='${NonPromoProductName}']"/>
    <parameter name="text" value="${NonPromoProductName}"/>
  </module>
  <action name="VERIFY_NoPromotion"/>
  <command name="pause" value="1500"/>
  <command name="assertXpathCount" target="//*[contains(text(),'${PromotionName}')]" value="0"/>
  <action name="Refine"/>
  <command name="pause" value="1000"/>
  <module name="library.module.app.sitegenesis.OpenCatalogDisplayCategoryLevel2">
    <parameter name="Level1CategoryName" value="${CatalogLevel1}"/>
    <parameter name="Level2CategoryName" value="${CatalogLevel2}"/>
  </module>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="//a[text()=&quot;${CatalogLevel3}&quot;]"/>
  </module>
  <action name="VERIFY-PromotionCallouts"/>
  <command name="pause" value="1500"/>
  <command name="assertXpathCount" target="//*[contains(text(),'${PromotionName}')]" value="5"/>
  <action name="SelectProduct"/>
  <module name="library.module.app.sitegenesis.productgriddisplay.ClickProductQuickViewLink">
    <parameter name="ProductName" value="${ProductName}"/>
  </module>
  <action name="UseQuickViewToAddProductToCart"/>
  <module name="library.module.app.sitegenesis.quickview.AddToCart"/>
  <action name="VERIFY-PromoNotInShoppingCart"/>
  <module name="library.module.app.sitegenesis.header.OpenShoppingCart"/>
  <command name="assertXpathCount" target="//*[contains(text(),'${PromotionName}')]" value="0"/>
  <action name="ChangeQuantity"/>
  <module name="library.function.FType">
    <parameter name="typeElement" value="css=td.item-quantity  &gt; input.input-text "/>
    <parameter name="inputString" value="2"/>
  </module>
  <module name="library.function.FClickAndWait">
    <parameter name="clickElement" value="css=button#update-cart"/>
  </module>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="css=button#update-cart"/>
  </module>
  <action name="VERIFY-PromoCalloutAndDiscountAmount"/>
  <command name="pause" value="1500"/>
  <module name="library.function.FAssertText">
    <parameter name="textElement" value="//tr[@class='order-discount discount']/td[2]"/>
    <parameter name="textPattern" value="${ExpectedDiscount}"/>
  </module>
  <module name="library.function.FAssertText">
    <parameter name="textElement" value="//tr[@class='order-total']/td[2]"/>
    <parameter name="textPattern" value="${ExpectedPrice}"/>
  </module>
  <module name="library.function.FAssertText">
    <parameter name="textElement" value="//td[@class='cart-promo']/div/span[2]"/>
    <parameter name="textPattern" value="${PromotionName}"/>
  </module>
  <action name="CleanUp"/>
  <module name="library.module.app.busmgr.DisablePromotion">
    <parameter name="SiteName" value="${SiteName}"/>
    <parameter name="PromotionName" value="${PromotionName}"/>
  </module>
</testcase>