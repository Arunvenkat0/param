<?xml version="1.0" encoding="UTF-8"?>
<testcase xmlns="http://xlt.xceptance.com/xlt-script/2" version="4" junit-test="true">
  <tags>C85037</tags>
  <description>Test Case ID:(C85037) Smoke Test » My Account - Returning Customer » Wish List » Send Wishlist To Friend</description>
  <module name="modules.staticelements.Homepage"/>
  <action name="SearchProduct"/>
  <module name="modules.search.SearchProductByIDOrName">
    <comment>Search for first product</comment>
    <parameter name="SearchText" value="${ProductName}"/>
  </module>
  <module name="modules.catalog.ValidateProductDetailsPageStructure"/>
  <module name="modules.catalog.ValidateProductDataOnDetailsPage">
    <parameter name="Name" value="${ProductName}"/>
    <parameter name="Price" value="${ProductPrice}"/>
  </module>
  <action name="AddToWishlistAndRegister"/>
  <module name="modules.wishlist.AddToWishlistAndRegister">
    <parameter name="ProductID" value="${ProductID}"/>
    <parameter name="ProductName" value="${ProductName}"/>
    <parameter name="ProductPrice" value="${ProductPrice}"/>
  </module>
  <action name="SendWishlistToFriend"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="id=send-to-friend"/>
  </module>
  <command name="waitForText" target="id=ui-dialog-title-send-to-friend-dialog" value="regexpi:Send to a Friend"/>
  <command name="assertValue" target="id=dwfrm_sendtofriend_yourname" value="${UserFirstName} ${UserLastName}"/>
  <command name="assertTextPresent" value="${Email}"/>
  <action name="EnterFormData"/>
  <module name="library.function.FType">
    <parameter name="typeElement" value="id=dwfrm_sendtofriend_friendsname"/>
    <parameter name="inputString" value="${FriendsName}"/>
  </module>
  <command name="store" target="${RANDOM.String(8)}@varmail.de" value="FriendsEmail"/>
  <module name="library.function.FType">
    <parameter name="typeElement" value="id=dwfrm_sendtofriend_friendsemail"/>
    <parameter name="inputString" value="${FriendsEmail}"/>
  </module>
  <module name="library.function.FType">
    <parameter name="typeElement" value="id=dwfrm_sendtofriend_confirmfriendsemail"/>
    <parameter name="inputString" value="${FriendsEmail}"/>
  </module>
  <command name="store" target="${RANDOM.String(125)}" value="Message"/>
  <module name="library.function.FType">
    <parameter name="typeElement" value="id=dwfrm_sendtofriend_message"/>
    <parameter name="inputString" value="${Message}"/>
  </module>
  <command name="assertText" target="css=.char-count" value="You have 125 characters left out of 250"/>
  <action name="OpenPreview"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="css=#send-to-friend-main .preview-button"/>
  </module>
  <command name="waitForText" target="css=#send-to-friend-main h2" value="Review Your Message"/>
  <command name="assertText" target="css=.send-to-friend-product" value="glob:To:*${FriendsName}*${FriendsEmail}*"/>
  <command name="assertText" target="css=.send-to-friend-product" value="glob:*From:*${UserFirstName} ${UserLastName}*${Email}*"/>
  <command name="assertText" target="css=.send-to-friend-product" value="glob:*Message:*${Message}*"/>
  <action name="SendMessage"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="css=#send-to-friend-dialog .send-button"/>
  </module>
  <command name="pause" value="1500"/>
  <command name="waitForTextPresent" value="Your message has been sent."/>
  <action name="CloseConfirmationDialog"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="css=.close-button"/>
  </module>
  <module name="modules.wishlist.ValidateAccountWishlistPageStructure"/>
  <action name="GoToWelcomePage"/>
  <module name="library.function.FClickAndWaitForPageLoad">
    <parameter name="clickElement" value="css=.user-account"/>
  </module>
  <action name="LogoutAndGoToHomepage"/>
  <module name="modules.usermanagement.LogOutFromWelcomePage"/>
  <action name="GoToHome"/>
  <module name="modules.staticelements.Return2Home"/>
</testcase>