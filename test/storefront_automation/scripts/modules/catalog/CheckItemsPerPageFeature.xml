<?xml version="1.0" encoding="UTF-8" ?>
<scriptmodule version="3" xmlns="http://xlt.xceptance.com/xlt-script/2">
  <description>Checks consequences for changing items per page:
- no changes in SortBy
- no changes in number if results
- no changes in order of products (first/last product)
- same products (first/last product)
- changes in number of items on page
- changes in pagination
Static Elements are:
- Sort Mode
- MaxItems</description>
  <parameter name="ItemsPerPage"/>
  <parameter name="SortMethod"/>
  <parameter name="ShownProductsFirstPage"/>
  <action name="SelectItemsPerPage"/>
  <command name="waitForElementPresent" target="name=Product-Paging-Options"/>
  <action name="SelectPagingOption"/>
  <command name="select" target="css=.search-result-options .items-per-page select" value="label=@{ItemsPerPage}">
    <comment>Select the desired amount of items per page.</comment>
  </command>
  <command name="pause" disabled="true" value="500">
    <comment>We have to give JQuery a moment to do its magic.</comment>
  </command>
  <module name="library.function.FWaitForText">
    <parameter name="textElement" value="css=.pagination .results-hits"/>
    <parameter name="text" value="regexp:.*Showing [0-9]{1,} - @{ItemsPerPage} of [0-9]{1,} Results.*"/>
  </module>
  <command name="waitForText" disabled="true" target="css=.pagination .results-hits" value="regexp:.*Showing [0-9]{1,} - @{ItemsPerPage} of [0-9]{1,} Results.*"/>
  <module name="library.function.FStoreText">
    <parameter name="textElement" value="css=.results-hits"/>
    <parameter name="textStoreVariableName" value="PaginationText"/>
  </module>
  <command name="storeText" disabled="true" target="css=.results-hits" value="PaginationText"/>
  <module name="library.function.FStoreText">
    <parameter name="textElement" value="css= .current-page"/>
    <parameter name="textStoreVariableName" value="CurrentPage"/>
  </module>
  <command name="storeText" disabled="true" target="css= .current-page" value="CurrentPage"/>
  <module name="modules.catalog.CompareSearchResultContainers">
    <parameter name="SortMethod" value="@{SortMethod}"/>
    <parameter name="ItemsPerPage" value="@{ItemsPerPage}"/>
  </module>
  <action name="SelectLastPage"/>
  <module name="library.function.FClickAndWaitFor">
    <parameter name="clickElement" value="css=.pagination li:last-child a"/>
    <parameter name="waitForElement" value="css=.page-1"/>
  </module>
  <command name="click" disabled="true" target="css=.pagination li:last-child a">
    <comment>Switch to last page.</comment>
  </command>
  <command name="waitForElementPresent" disabled="true" target="css=.page-1">
    <comment>Wait for the page switch (link to fist page is visible).</comment>
  </command>
  <module name="library.function.FStoreText">
    <parameter name="textElement" value="css=.results-hits"/>
    <parameter name="textStoreVariableName" value="PaginationText"/>
  </module>
  <command name="storeText" disabled="true" target="css=.results-hits" value="PaginationText"/>
  <module name="library.function.FStoreText">
    <parameter name="textElement" value="css= .current-page"/>
    <parameter name="textStoreVariableName" value="CurrentPage"/>
  </module>
  <command name="storeText" disabled="true" target="css= .current-page" value="CurrentPage"/>
  <module name="modules.catalog.CompareSearchResultContainers">
    <parameter name="SortMethod" value="@{SortMethod}"/>
    <parameter name="ItemsPerPage" value="@{ItemsPerPage}"/>
  </module>
</scriptmodule>
