<?xml version="1.0" encoding="UTF-8"?>
<scriptmodule xmlns="http://xlt.xceptance.com/xlt-script/2" version="4">
  <description>Adds a credit card to the Payment Settings</description>
  <parameter name="Name"/>
  <parameter name="Type"/>
  <parameter name="Number"/>
  <parameter name="ExpireDateMonth"/>
  <parameter name="ExpireDateYear"/>
  <parameter name="HeaderElement"/>
  <action name="ClickLinkToAddCreditCard"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="link=Add a Credit Card"/>
  </module>
  <module name="library.function.FWaitForElement">
    <parameter name="element" value="css=#ui-dialog-title-dialog-container"/>
  </module>
  <command name="waitForText" target="@{HeaderElement}" value="regexpi:ADD A CREDIT CARD"/>
  <module name="modules.payments.ValidateCreditCardRequiredFields"/>
  <action name="EnterCreditCardData"/>
  <module name="library.function.FType">
    <parameter name="typeElement" value="xpath=//input[contains(@id, 'owner')]"/>
    <parameter name="inputString" value="@{Name}"/>
  </module>
  <module name="library.function.FSelect">
    <parameter name="element" value="xpath=//select[contains(@id, 'type')]"/>
    <parameter name="selection" value="label=@{Type}"/>
  </module>
  <module name="library.function.FType">
    <parameter name="typeElement" value="xpath=//input[contains(@id, 'number')]"/>
    <parameter name="inputString" value="@{Number}"/>
  </module>
  <module name="library.function.FSelect">
    <parameter name="element" value="xpath=//select[contains(@id, 'year')]"/>
    <parameter name="selection" value="label=@{ExpireDateYear}"/>
  </module>
  <module name="library.function.FSelect">
    <parameter name="element" value="xpath=//select[contains(@id, 'month')]"/>
    <parameter name="selection" value="label=@{ExpireDateMonth}"/>
  </module>
  <action name="ApplyCreditCardData"/>
  <module name="library.function.FClickAndWaitForPageLoad">
    <parameter name="clickElement" value="id=applyBtn"/>
  </module>
</scriptmodule>