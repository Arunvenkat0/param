<?xml version="1.0" encoding="UTF-8" ?>
<scriptmodule version="3" xmlns="http://xlt.xceptance.com/xlt-script/2">
  <description>Checks available shipping methods and selects the one of the module parameter.

Shipping discount was not considered.
This module only works without shipping discount (ex. Free Ground Shipping Over $150).</description>
  <parameter name="ShippingMethodNumber"/>
  <parameter name="ShippingMethodName"/>
  <action name="SelectAndValidateFirstShippingMethod"/>
  <command name="waitForElementPresent" target="id=shipping-method-001">
    <comment>This might turn up later due to background Ajax, so wait for it.</comment>
  </command>
  <command name="check" target="id=shipping-method-001"/>
  <command name="assertText" target="xpath=id('shipping-method-list')/fieldset/div[1]/label" value="glob:Ground:*"/>
  <command name="assertText" target="xpath=id('shipping-method-list')/fieldset/div[1]/label/span" value="regexp:^\$\s*([0-9]|([1-9][0-9]{0,2}))\.99$"/>
  <command name="storeText" target="xpath=id('shipping-method-list')/fieldset/div[1]/label/span" value="Shipping_Costs"/>
  <command name="waitForText" target="xpath=id('secondary')/div[@class='checkout-order-totals']//tr[contains(@class,'order-shipping')]" value="glob:*Ground*"/>
  <command name="waitForText" target="xpath=id('secondary')/div[@class='checkout-order-totals']//tr[contains(@class,'order-shipping')]/td[2]" value="${Shipping_Costs}"/>
  <action name="SelectAndValidateSecondShippingMethod"/>
  <command name="check" target="id=shipping-method-002"/>
  <command name="waitForText" target="xpath=id('shipping-method-list')/fieldset/div[2]/label" value="@{ShippingMethodName}*"/>
  <command name="assertText" target="xpath=id('shipping-method-list')/fieldset/div[2]/label/span" value="regexp:^\$\s*([0-9]|([1-9][0-9]{0,2}))\.99$"/>
  <command name="waitForText" target="xpath=id('secondary')/div[@class='checkout-order-totals']//tr[contains(@class,'order-shipping')]" value="glob:*@{ShippingMethodName}*"/>
  <action name="SelectAndValidateThirdShippingMethod"/>
  <command name="check" target="id=shipping-method-003"/>
  <command name="waitForText" target="xpath=id('shipping-method-list')/fieldset/div[3]/label" value="Overnight*"/>
  <command name="assertText" target="xpath=id('shipping-method-list')/fieldset/div[3]/label/span" value="regexp:^\$\s*([0-9]|([1-9][0-9]{0,2}))\.99$"/>
  <command name="waitForText" target="xpath=id('secondary')/div[@class='checkout-order-totals']//tr[contains(@class,'order-shipping')]" value="glob:*Overnight*"/>
  <action name="SelectShippingMethodForCheckout"/>
  <command name="check" target="id=shipping-method-00@{ShippingMethodNumber}">
    <comment>Select Shipping Method</comment>
  </command>
  <command name="waitForText" target="xpath=id('shipping-method-list')/fieldset/div[2]/label" value="@{ShippingMethodName}*"/>
</scriptmodule>
