<?xml version="1.0" encoding="UTF-8" ?>
<scriptmodule version="3" xmlns="http://xlt.xceptance.com/xlt-script/2">
  <description>Clicks the store link for a product and searches for a zip code. After selecting the first store at the result list the overlay closes. 
Overlay is opened again to do another search by clicking change location link.
Another zip code is used for the second search.</description>
  <parameter name="ZipCodeStore1"/>
  <parameter name="ZipCodeStore2"/>
  <action name="OpenStoreSelectionOverlay"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="link=Select Store"/>
  </module>
  <command name="click" disabled="true" target="link=Select Store"/>
  <module name="library.function.FType">
    <parameter name="typeElement" value="id=userZip"/>
    <parameter name="inputString" value="@{ZipCodeStore1}"/>
  </module>
  <command name="type" disabled="true" target="id=userZip" value="@{ZipCodeStore1}"/>
  <action name="SearchForStoreZipCode1"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="id=set-user-zip"/>
  </module>
  <command name="click" disabled="true" target="id=set-user-zip"/>
  <module name="library.function.FAssertCaseInsensitiveTextOnPage">
    <parameter name="text" value="@{ZipCodeStore1}"/>
  </module>
  <command name="assertTextPresent" disabled="true" value="@{ZipCodeStore1}"/>
  <command name="assertElementPresent" target="css=.update-location"/>
  <command name="waitForElementPresent" target="css=.store-list .store-tile"/>
  <command name="assertElementPresent" target="css=.select-store-button"/>
  <command name="assertElementPresent" target="css=#listings-nav"/>
  <action name="SelectPickUpStore1"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="css=.select-store-button"/>
  </module>
  <command name="click" disabled="true" target="css=.select-store-button"/>
  <command name="waitForElementPresent" target="css=.selected-store-address"/>
  <command name="waitForElementPresent" disabled="true" target="link=Select Store"/>
  <action name="OpenStoreSelectionOverlayAgain"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="link=Select Store"/>
  </module>
  <command name="click" disabled="true" target="link=Select Store"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="css=.update-location"/>
  </module>
  <command name="click" disabled="true" target="css=.update-location"/>
  <module name="library.function.FType">
    <parameter name="typeElement" value="id=userZip"/>
    <parameter name="inputString" value="@{ZipCodeStore2}"/>
  </module>
  <command name="type" disabled="true" target="id=userZip" value="@{ZipCodeStore2}"/>
  <action name="SearchForStoreZipCode2"/>
  <module name="library.function.FClick">
    <parameter name="clickElement" value="id=set-user-zip"/>
  </module>
  <command name="click" disabled="true" target="id=set-user-zip"/>
  <module name="library.function.FAssertCaseInsensitiveTextOnPage">
    <parameter name="text" value="@{ZipCodeStore2}"/>
  </module>
  <command name="assertTextPresent" disabled="true" value="@{ZipCodeStore2}"/>
  <command name="assertElementPresent" target="css=.update-location"/>
  <command name="assertElementPresent" target="css=.store-list .store-tile"/>
  <command name="assertElementPresent" target="css=.select-store-button"/>
  <command name="assertElementPresent" target="css=#listings-nav"/>
  <action name="SelectPickUpStore2"/>
  <module name="library.function.FClickAndWaitFor">
    <parameter name="clickElement" value="css=.select-store-button"/>
    <parameter name="waitForElement" value="css=.selected-store-address"/>
  </module>
  <command name="click" disabled="true" target="css=.select-store-button"/>
  <command name="waitForElementPresent" disabled="true" target="css=.selected-store-address"/>
</scriptmodule>
