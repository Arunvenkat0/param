<?xml version="1.0" encoding="UTF-8"?>
<scriptmodule version="3" xmlns="http://xlt.xceptance.com/xlt-script/2">
  <description>Adds a credit card to the Payment Settings</description>
  <parameter name="Name"/>
  <parameter name="Type"/>
  <parameter name="Number"/>
  <parameter name="ExpireDateMonth"/>
  <parameter name="ExpireDateYear"/>
  <action name="ClickLinkToAddCreditCard"/>
  <command name="waitForElementPresent" target="link=Add a Credit Card"/>
  <command name="click" target="link=Add a Credit Card"/>
  <command name="waitForText" target="css=#dialog-container h1" value="Add a Credit Card"/>
  <module name="modules.payments.ValidateCreditCardRequiredFields"/>
  <action name="EnterCreditCardData"/>
  <command name="type" target="xpath=//input[contains(@id, 'owner')]" value="@{Name}"/>
  <command name="select" target="xpath=//select[contains(@id, 'type')]" value="label=@{Type}"/>
  <command name="type" target="xpath=//input[contains(@id, 'number')]" value="@{Number}"/>
  <command name="select" target="xpath=//select[contains(@id, 'year')]" value="label=@{ExpireDateYear}"/>
  <command name="select" target="xpath=//select[contains(@id, 'month')]" value="label=@{ExpireDateMonth}"/>
  <action name="Apply"/>
  <command name="clickAndWait" target="id=applyBtn"/>
</scriptmodule>